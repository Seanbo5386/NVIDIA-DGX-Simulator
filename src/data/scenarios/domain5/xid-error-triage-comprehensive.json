{
  "id": "domain5-xid-triage",
  "title": "Comprehensive XID Error Triage",
  "domain": "domain5",
  "difficulty": "advanced",
  "description": "Master the complete XID error triage workflow for DGX systems. Learn to identify, categorize, and resolve the most common GPU XID errors that affect AI workloads.",
  "learningObjectives": [
    "Understand XID error categories",
    "Triage multiple XID types",
    "Determine root causes",
    "Implement resolution steps",
    "Know when to escalate"
  ],
  "faults": [
    {
      "type": "xid_error",
      "xidCode": 79,
      "gpuIndex": 3
    }
  ],
  "initialClusterState": {},
  "steps": [
    {
      "id": "step1",
      "title": "Detect XID Errors",
      "description": "Learn how to detect and identify XID errors in the system.",
      "objectives": [
        "Check nvidia-smi for errors",
        "Search kernel logs",
        "Identify affected GPUs"
      ],
      "expectedCommands": [
        "nvidia-smi",
        "dmesg | grep -i nvrm",
        "dmesg | grep -i xid"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must detect XID errors",
          "expectedCommands": ["nvidia-smi", "dmesg | grep -i xid"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "XID errors appear in dmesg as 'Xid'",
        "nvidia-smi may show 'ERR!' in display",
        "NVRM messages indicate driver issues",
        "Note GPU index from error message",
        "Timestamp helps correlate with workloads"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "XID Errors",
          "url": "https://docs.nvidia.com/deploy/xid-errors/"
        }
      ]
    },
    {
      "id": "step2",
      "title": "Categorize XID Error Types",
      "description": "Learn to categorize XID errors by severity and cause.",
      "objectives": [
        "Understand XID categories",
        "Identify error severity",
        "Know common XID codes"
      ],
      "expectedCommands": [
        "dmesg | grep -i xid | tail -20",
        "nvidia-smi -q -d ECC"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must categorize XID errors",
          "expectedCommands": ["dmesg | grep -i xid", "nvidia-smi -q -d ECC"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "XID 13: Graphics engine exception",
        "XID 31: GPU memory page fault",
        "XID 48: Double-bit ECC error",
        "XID 63: ECC page retirement",
        "XID 79: GPU fallen off bus (critical)",
        "XID 119: GSP error"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "XID Error Reference",
          "url": "https://docs.nvidia.com/deploy/xid-errors/"
        }
      ]
    },
    {
      "id": "step3",
      "title": "Triage XID 79 - GPU Fallen Off Bus",
      "description": "Handle the critical XID 79 error indicating GPU disconnection.",
      "objectives": [
        "Identify XID 79 causes",
        "Check PCIe status",
        "Determine recovery steps"
      ],
      "expectedCommands": [
        "dmesg | grep -i 'xid 79\\|fallen off'",
        "lspci | grep -i nvidia",
        "nvidia-smi"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must triage XID 79",
          "expectedCommands": ["dmesg | grep -i xid", "lspci | grep -i nvidia"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "XID 79 = GPU lost PCIe connection",
        "Causes: PCIe instability, power issue, hardware fault",
        "Check lspci for missing GPU",
        "Often requires system reboot",
        "Persistent XID 79 = hardware replacement"
      ],
      "estimatedDuration": 8,
      "documentationLinks": [
        {
          "title": "XID 79",
          "url": "https://docs.nvidia.com/deploy/xid-errors/"
        }
      ]
    },
    {
      "id": "step4",
      "title": "Triage XID 48 - Double-Bit ECC Error",
      "description": "Handle ECC memory errors that indicate potential GPU memory issues.",
      "objectives": [
        "Check ECC error counts",
        "Understand volatile vs persistent",
        "Assess GPU health"
      ],
      "expectedCommands": [
        "nvidia-smi -q -d ECC",
        "nvidia-smi --query-gpu=ecc.errors.uncorrected.volatile.total --format=csv"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must triage XID 48",
          "expectedCommands": ["nvidia-smi -q -d ECC"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "XID 48 = uncorrectable ECC error",
        "Volatile errors clear on reboot",
        "Persistent errors require page retirement",
        "Monitor with DCGM for trends",
        "Frequent XID 48 = GPU replacement"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "ECC Errors",
          "url": "https://docs.nvidia.com/deploy/xid-errors/"
        }
      ]
    },
    {
      "id": "step5",
      "title": "Triage XID 63 - ECC Page Retirement",
      "description": "Handle automatic page retirement due to ECC errors.",
      "objectives": [
        "Check retired pages",
        "Understand retirement limits",
        "Monitor page retirement"
      ],
      "expectedCommands": [
        "nvidia-smi -q -d PAGE_RETIREMENT",
        "nvidia-smi --query-gpu=retired_pages.pending,retired_pages.sbe,retired_pages.dbe --format=csv"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must triage XID 63",
          "expectedCommands": ["nvidia-smi -q -d PAGE_RETIREMENT"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "XID 63 = page retired due to ECC",
        "Retirement is automatic protection",
        "Pending retirements need reboot",
        "Excessive retirements = GPU issue",
        "Check dbe vs sbe counts"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "Page Retirement",
          "url": "https://docs.nvidia.com/deploy/xid-errors/"
        }
      ]
    },
    {
      "id": "step6",
      "title": "Triage XID 31 - GPU Memory Page Fault",
      "description": "Diagnose memory page faults which often indicate software issues.",
      "objectives": [
        "Identify page fault causes",
        "Distinguish software vs hardware",
        "Debug application issues"
      ],
      "expectedCommands": [
        "dmesg | grep -i 'xid 31'",
        "nvidia-smi",
        "nvidia-smi -q -d MEMORY"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must triage XID 31",
          "expectedCommands": [
            "dmesg | grep -i xid",
            "nvidia-smi -q -d MEMORY"
          ],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "XID 31 = illegal memory access",
        "Often software/application bug",
        "Check for CUDA memory errors",
        "Could be driver issue",
        "Consistent with specific app = app bug"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "XID 31",
          "url": "https://docs.nvidia.com/deploy/xid-errors/"
        }
      ]
    },
    {
      "id": "step7",
      "title": "Implement Recovery Procedures",
      "description": "Apply appropriate recovery steps based on XID type.",
      "objectives": [
        "Reset GPU if applicable",
        "Clear volatile errors",
        "Determine if reboot needed"
      ],
      "expectedCommands": [
        "nvidia-smi -r -i 3",
        "nvidia-smi",
        "dmesg | tail -30"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must implement recovery",
          "expectedCommands": ["nvidia-smi -r", "nvidia-smi"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "GPU reset may clear transient errors",
        "Some XID require full reboot",
        "XID 79 usually needs cold reboot",
        "Clear page retirements with reboot",
        "Persistent errors indicate hardware"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "GPU Reset",
          "url": "https://docs.nvidia.com/datacenter/"
        }
      ]
    },
    {
      "id": "step8",
      "title": "Document and Escalate",
      "description": "Document findings and escalate hardware issues.",
      "objectives": [
        "Generate bug report",
        "Document error history",
        "Know escalation criteria"
      ],
      "expectedCommands": [
        "nvidia-bug-report.sh",
        "dmesg > xid_investigation.log",
        "nvidia-smi -q >> xid_investigation.log"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must document and escalate",
          "expectedCommands": ["nvidia-bug-report.sh", "dmesg >"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Run nvidia-bug-report.sh for support",
        "Include dmesg and nvidia-smi output",
        "Note error frequency and timing",
        "Escalate: persistent XID 48/63/79",
        "Contact NVIDIA Enterprise Support"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "NVIDIA Support",
          "url": "https://enterprise-support.nvidia.com/"
        }
      ]
    }
  ],
  "successCriteria": [
    "Detected XID errors",
    "Categorized XID error types",
    "Triaged XID 79",
    "Triaged XID 48",
    "Triaged XID 63",
    "Triaged XID 31",
    "Implemented recovery procedures",
    "Documented and escalated appropriately"
  ],
  "estimatedTime": 55,
  "prerequisites": ["domain5-xid-error"],
  "tags": ["xid", "troubleshooting", "errors", "gpu-health", "advanced"],
  "tier": 3,
  "commandFamilies": ["gpu-monitoring", "diagnostics"],
  "explanationGateId": "gate-domain5-xid-triage",
  "toolHints": false
}
